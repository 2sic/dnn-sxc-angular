This guide will help you to create a new 2sxc app with Angular 5. It assumes you have already used 2sxc and know how to add apps, views and content types. If this is not the case, please start with a [guide to create your own app?]. Before you start, make sure you have installed 2sxc 9+.
The guide was tested with Angular CLI 6.1.4; the files may differ for later versions.

Instead of following this guide you can download the prepared 2sxc sample app here: https://github.com/2sic/app-dnn-sxc-angular-dev

## Prepare basic Angular app
1. Navigate to `/Portals/0/2sxc` (depending of your portal root folder, replace the portal path) and follow the [quickstart guide of Angular](https://angular.io/guide/quickstart) which will create a directory with the angular app contents.

1. Run `npm install "@2sic.com/dnn-sxc-angular" --save` to add the dnn-sxc-angular connector

1. Run `npm run build` to build the app. Angular will build the app into the `/dist` folder.

1. Copy `index.html` from `/dist/[app-name]/` to the root of your app and name it `_Index.cshtml`. We will use this file as our 2sxc template file. We can't use the index file generated by Angular, because we want to integrate it into DNN (we don't need the html, body tags etc.).

1. Open `_Index.cshtml` and remove doctype, html, meta, title, link and body tags. Then adapt the path for the JavaScript files to correspond to their location. The file should look like this:
```html
<base href="/">
<app-root></app-root>

<script type="text/javascript" src="@App.Path/dist/my-app/runtime.js"></script>
<script type="text/javascript" src="@App.Path/dist/my-app/polyfills.js"></script>
<script type="text/javascript" src="@App.Path/dist/my-app/styles.js"></script>
<script type="text/javascript" src="@App.Path/dist/my-app/vendor.js"></script>
<script type="text/javascript" src="@App.Path/dist/my-app/main.js"></script></body>
```

## Register and prepare app in 2sxc
1. Create a new 2sxc app from the App module in DNN. To ensure the app will place its files in the same directory, use the same app name as for the Angular app. Place the app on a page.

1. From the app configuration, create a new Razor view and select `_Index.cshtml` as its template file.

1. View the app - it should display the Angular welcome message and example text. If you don't need any 2sxc data in your app, you are good to go. Otherwise, continue below.

## Make app aware of 2sxc context
In order to use 2sxc data in Angular, we need to convert our main component to extend `DnnComponent` and add some providers.
1. Open `app.module.ts` and add `HttpClientModule` to the imports and `DnnInterceptor` to providers. At the top, add these imports:
```typescript
import { HttpClientModule } from '@angular/common/http';
import { DnnInterceptor } from '@2sic.com/dnn-sxc-angular';
```


1. Open `app.component.ts` and change its content to:
```typescript
import { Component, ElementRef } from '@angular/core';
import { DnnAppComponent, Context } from '@2sic.com/dnn-sxc-angular';

@Component({
  selector: 'app-root',
  templateUrl: './app.component.html',
  styleUrls: ['./app.component.css']
})
export class AppComponent extends DnnAppComponent {
  constructor(
      el: ElementRef,
      context: Context
  ) {
      super(el, context);
  }
  title = 'my-app';
}
```
Changes to the original file are: Added imports at the top, added `extends DnnAppComponent`, added constructor.

The app is now able to use 2sxc services and data.

## Get 2sxc data in an Angular component
1. Create a content type named `Person` which we will access later from our angular app. Add a string field `Name` and create a sample entity / record.

1. In the content type list, you can [define permissions](https://2sxc.org/en/Learn/Permissions) by clicking the user icon. In this example, we want the content type to be accessible anonymously. Grant `Read` permission to the access level `SecurityAccessLevel.View`.

1. We will add a component that displays the list of people. Create a folder `/src/app/person` and add the two files `person-list.component.ts` and `person.component.ts` to it. (TODO: Links)

1. Open `app.component.html` and add the following code to the end:
    ```html
    <person-list></person-list>
    ```

1. Open `app.module.ts` and register the new components. At the top, add the imports:
    ```typescript
    import { PersonListComponent } from './person/person-list.component'
    import { PersonComponent } from './person/person.component'
    ```

    In the declarations array, add both:
    ```typescript
    declarations: [
        AppComponent,
        PersonListComponent,
        PersonComponent
    ],
    ```

1. Reload the page and check if the sample entry is displayed.

## Production build
If you run `npm run build` or just `ng build`, Angular builds in development mode. To create a production build, run `ng build --prod`. Because the build looks a bit different in production mode, we can make some adjustments to the configuration (for example, to ensure the build files are named in the same way as in development build).

Open `angular.json` and change the configuration of the production build:
1. Set `outputHashing` to `none`
1. Set `sourceMap` to `true`
1. Set `vendorChunk` to `true`

Run `ng build --prod` to build in production mode.


## Troubleshooting
If the app does not run
* Check browser console and terminal for errors
* Make sure you are not in page edit mode
* ...?